import{y as w,c as L,r as n,em as C,j as t,S,p as x,el as I,ek as q,cT as B,eq as E,C as G,B as _,R as N,e as P,dB as g,W as A}from"./index-fc31389b.js";import{o as T}from"./orderBy-f223fbfc.js";import{E as D}from"./empty-content-f8c8f2e9.js";import{C as U}from"./custom-breadcrumbs-55e72b55.js";import{a as V,b as W,c as z,d as H,e as J}from"./tour-details-view-8d85ab5e.js";import"./_baseToString-fe72bdcf.js";import"./_baseIteratee-18574c25.js";import"./_baseEach-e1a0d60c.js";import"./format-number-8ee044d8.js";import"./image-9d9e55ff.js";import"./custom-date-range-picker-d6a48a99.js";import"./DialogTitle-79e656a6.js";import"./dialogTitleClasses-ab79cbbb.js";import"./DialogContent-1d2c436b.js";import"./DatePicker-8c2b151f.js";import"./TextField-c5c5e45f.js";import"./FormControl-47574643.js";import"./FormLabel-a4ed3336.js";import"./Select-5f4f2f3f.js";import"./Menu-40ee519e.js";import"./DialogActions-cfb1f284.js";import"./ListItem-c8d87749.js";import"./ListItemSecondaryAction-e6a07c9d.js";import"./Chip-276a27ce.js";import"./Pagination-6c92d77f.js";import"./FirstPage-356a7ad5.js";import"./Autocomplete-79c5288c.js";import"./Close-2819fb88.js";import"./FormControlLabel-f8d84e00.js";import"./Checkbox-1984f828.js";import"./SwitchBase-8d5bb026.js";import"./rhf-autocomplete-947a9911.js";import"./upload-avatar-2f1e41c5.js";import"./fade-b19d01ee.js";import"./index-ec23ed6d.js";import"./FormGroup-32a713d2.js";import"./Switch-eb36a74c.js";import"./editor-a8953f53.js";import"./highlight-ad88e5bf.js";import"./Slider-7bd9077b.js";import"./visuallyHidden-14c3de6e.js";import"./RadioGroup-715ee6cf.js";import"./Radio-d0af1f14.js";import"./yup-674d2aca.js";import"./CardHeader-a7b93930.js";import"./LoadingButton-1fae9005.js";import"./CircularProgress-d1c25c6e.js";import"./markdown-5ca73b49.js";import"./use-light-box-6fa02391.js";const y={destination:[],tourGuides:[],services:[],startDate:null,endDate:null};function K(){const e=w(),m=L(),[a,j]=n.useState("latest"),[i,c]=n.useState({query:"",results:[]}),[s,d]=n.useState(y),f=s.startDate&&s.endDate?s.startDate.getTime()>s.endDate.getTime():!1,l=M({inputData:C,filters:s,sortBy:a,dateError:f}),r=!!s.destination.length||!!s.tourGuides.length||!!s.services.length||!!s.startDate&&!!s.endDate,p=!l.length&&r,b=n.useCallback((o,u)=>{d(h=>({...h,[o]:u}))},[]),O=n.useCallback(o=>{j(o)},[]),R=n.useCallback(o=>{if(c(u=>({...u,query:o})),o){const u=C.filter(h=>h.name.toLowerCase().indexOf(i.query.toLowerCase())!==-1);c(h=>({...h,results:u}))}},[i.query]),F=n.useCallback(()=>{d(y)},[]),k=t.jsxs(S,{spacing:3,justifyContent:"space-between",alignItems:{xs:"flex-end",sm:"center"},direction:{xs:"column",sm:"row"},children:[t.jsx(V,{query:i.query,results:i.results,onSearch:R,hrefItem:o=>x.dashboard.tour.details(o)}),t.jsxs(S,{direction:"row",spacing:1,flexShrink:0,children:[t.jsx(W,{open:m.value,onOpen:m.onTrue,onClose:m.onFalse,filters:s,onFilters:b,canReset:r,onResetFilters:F,serviceOptions:I.map(o=>o.label),tourGuideOptions:q,destinationOptions:B,dateError:f}),t.jsx(z,{sort:a,onSort:O,sortOptions:E})]})]}),v=t.jsx(H,{filters:s,onResetFilters:F,canReset:r,onFilters:b,results:l.length});return t.jsxs(G,{maxWidth:e.themeStretch?!1:"lg",children:[t.jsx(U,{heading:"List",links:[{name:"Dashboard",href:x.dashboard.root},{name:"Tour",href:x.dashboard.tour.root},{name:"List"}],action:t.jsx(_,{component:N,href:x.dashboard.tour.new,variant:"contained",startIcon:t.jsx(P,{icon:"mingcute:add-line"}),children:"New Tour"}),sx:{mb:{xs:3,md:5}}}),t.jsxs(S,{spacing:2.5,sx:{mb:{xs:3,md:5}},children:[k,r&&v]}),p&&t.jsx(D,{title:"No Data",filled:!0,sx:{py:10}}),t.jsx(J,{tours:l})]})}const M=({inputData:e,filters:m,sortBy:a,dateError:j})=>{const{services:i,destination:c,startDate:s,endDate:d,tourGuides:f}=m,l=f.map(r=>r.id);return a==="latest"&&(e=T(e,["createdAt"],["desc"])),a==="oldest"&&(e=T(e,["createdAt"],["asc"])),a==="popular"&&(e=T(e,["totalViews"],["desc"])),j||s&&d&&(e=e.filter(r=>g(r.available.startDate)>=g(s)&&g(r.available.endDate)<=g(d))),c.length&&(e=e.filter(r=>c.includes(r.destination))),l.length&&(e=e.filter(r=>r.tourGuides.some(p=>l.includes(p.id)))),i.length&&(e=e.filter(r=>r.services.some(p=>i.includes(p)))),e};function zt(){return t.jsxs(t.Fragment,{children:[t.jsx(A,{children:t.jsx("title",{children:" Dashboard: Tour List"})}),t.jsx(K,{})]})}export{zt as default};
